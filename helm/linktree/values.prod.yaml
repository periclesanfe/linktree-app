# Production environment values for linktree

environment: production

backend:
  enabled: true
  replicaCount: 3

  image:
    repository: ghcr.io/periclesanfe/linktree-backend
    pullPolicy: IfNotPresent
    tag: ""
    pullSecrets:
      - name: ghcr-secret

  service:
    type: ClusterIP
    port: 8000
    annotations:
      prometheus.io/scrape: "true"
      prometheus.io/port: "8000"
      prometheus.io/path: "/metrics"

  config:
    nodeEnv: production
    corsOrigin: "https://linktree.yourdomain.com"
    port: 8000

  database:
    host: "linktree-prod-postgresql-rw"
    port: "5432"
    database: "linktree_db"
    user: "linktree_prod_user"
    credentialsSecret: "linktree-prod-postgres-credentials"

  auth:
    jwtSecretName: "linktree-prod-secrets"
    jwtSecretKey: "JWT_SECRET"

  resources:
    limits:
      cpu: 1000m
      memory: 1Gi
    requests:
      cpu: 500m
      memory: 512Mi

  autoscaling:
    enabled: true
    minReplicas: 3
    maxReplicas: 10
    targetCPUUtilizationPercentage: 70
    targetMemoryUtilizationPercentage: 80

  podDisruptionBudget:
    enabled: true
    minAvailable: 2

  affinity:
    podAntiAffinity:
      preferredDuringSchedulingIgnoredDuringExecution:
        - weight: 100
          podAffinityTerm:
            labelSelector:
              matchExpressions:
                - key: app.kubernetes.io/name
                  operator: In
                  values:
                    - linktree-backend
            topologyKey: kubernetes.io/hostname

frontend:
  enabled: true
  replicaCount: 3

  image:
    repository: ghcr.io/periclesanfe/linktree-frontend
    pullPolicy: IfNotPresent
    tag: ""
    pullSecrets:
      - name: ghcr-secret

  service:
    type: ClusterIP
    port: 80

  config:
    apiUrl: "http://linktree-prod-backend:8000"

  resources:
    limits:
      cpu: 300m
      memory: 384Mi
    requests:
      cpu: 150m
      memory: 192Mi

  autoscaling:
    enabled: true
    minReplicas: 3
    maxReplicas: 10
    targetCPUUtilizationPercentage: 70
    targetMemoryUtilizationPercentage: 80

  podDisruptionBudget:
    enabled: true
    minAvailable: 2

  affinity:
    podAntiAffinity:
      preferredDuringSchedulingIgnoredDuringExecution:
        - weight: 100
          podAffinityTerm:
            labelSelector:
              matchExpressions:
                - key: app.kubernetes.io/name
                  operator: In
                  values:
                    - linktree-frontend
            topologyKey: kubernetes.io/hostname
